<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Medieval Pixel Idle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="style.css"/>
  
  <style>
  /* Global reset to ensure full-bleed layout */
  html, body {
    width: 100%;
    height: 100%;
  }
  body {
    margin: 0; /* —É–±–∏—Ä–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –æ—Ç—Å—Ç—É–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ */
  }

 /* –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã */
.game-layout {
  width: 100%;       /* –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É –æ–∫–Ω–∞ */
  max-width: none;    /* —É–±–∏—Ä–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ */
  margin: 0;          /* —É–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ */
  box-sizing: border-box;
}

/* –°–µ—Ç–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ */
.game-columns {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr)); /* —Ç—Ä–∏ —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏ */
  gap: 20px;
  width: 100%;        /* —à–∏—Ä–∏–Ω–∞ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è */
  padding: 20px;
  align-items: start;
}


  /* Ensure left column content (cursor area + notifications) stacks vertically */
  .col-left {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 60vh;
    width: 100%;
  }

  /* Center column: buildings list should be scrollable and centered */
  .col-center {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 60vh;
    align-items: stretch;
    width: 100%;
  }
  #buildings-list {
    overflow-y: auto;
    max-height: calc(100vh - 320px);
    padding-right: 6px;
  }

  /* Right column: Uber building container */
  .col-right {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height:220px;
    align-items: stretch;
    width: 100%;
  }
  /* Make sure the Uber card visually matches building cards */
  .uber-building-card {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 12px;
    align-items: center;
    background: linear-gradient(180deg,#1f1b1a,#2b2624);
    border-radius:8px;
    padding:12px;
    border:2px solid rgba(0,0,0,0.6);
    box-shadow: inset 0 6px 12px rgba(0,0,0,0.45);
    min-height:220px;
  }
  .uber-pixel { width:80px;height:80px;border-radius:8px;background:linear-gradient(180deg,#3a2f2b,#1f1715);border:2px solid rgba(0,0,0,0.6); }
  .uber-actions { display:flex;flex-direction:column;gap:8px;align-items:flex-end; }

  /* Notifications / toasts styling adjustments to keep them compact */
  .notice-board { min-height: auto; max-height: 40vh; overflow-y: auto; }
  .toasts .toast { display:flex;align-items:center;gap:8px;justify-content:space-between; }

  /* Ensure click-area remains usable and not stretched */
  .click-area { width:100%; }

  /* Responsive: stack columns on small screens - handled by main CSS file */




</style>


</head>
<body style="background-image: url('icons/back.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;">

  <!-- FPS & Performance Monitor -->
  <div id="fps-monitor" class="fps-monitor">
    <div class="fps-item">
      <span class="fps-label">FPS:</span>
      <span id="fps-value" class="fps-value">--</span>
    </div>
    <div class="fps-item">
      <span class="fps-label">Frame:</span>
      <span id="frame-time-value" class="fps-value">--</span>
      <span class="fps-unit">ms</span>
    </div>
  </div>

  <!-- Offline Earnings Modal -->
  <div id="offline-earnings-modal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal-card" role="document">
      <div class="modal-header">
        <h3>Welcome Back!</h3>
      </div>
      <div class="modal-body" id="offline-earnings-body">
        <!-- Content will be filled by JavaScript -->
      </div>
      <div class="modal-footer">
        <button id="offline-earnings-ok" class="btn primary">OK</button>
      </div>
    </div>
  </div>

  <!-- DEBUG -->
  <div id="debug-modal" class="modal hidden">
    <div class="modal-card">
      <h2>Debug Panel</h2>

      <div id="debug-lock">
        <p>Enter password:</p>
        <input id="debug-pass" type="password" placeholder="Password"/>
        <button id="debug-unlock-btn" class="btn primary">Unlock</button>
      </div>

      <div id="debug-tools" class="hidden">
        <div class="debug-actions">
          <button class="btn secondary" data-debug="setPoints">Set points</button>
          <button class="btn secondary" data-debug="setBuildingLevels">Set level for buildings</button>
          <button class="btn secondary" data-debug="setClickLevel">Set level for click</button>
          <button class="btn secondary" data-debug="addAllBuildingLevels">Add 100 levels to all buildings</button>
          <button class="btn secondary" data-debug="addClickLevels">Add 100 levels to Click</button>
          <button class="btn secondary" data-debug="clickIncomeBoost">Click income x1000</button>
          <button class="btn secondary" data-debug="spawnSpider">Spawn spider</button>
          <button class="btn secondary" data-debug="spawnAngryBarmatun">Spawn Angry Barmatun</button>
          <button class="btn secondary" data-debug="spawnElfArcher">Spawn Elf Archer</button>
          <button class="btn secondary" data-debug="spawnKing">Spawn king</button>
          <button class="btn secondary" data-debug="addUberLevels">+10 levels to Citadel</button>
          <button class="btn secondary" data-debug="cycleSeason">Cycle season</button>
          <button class="btn secondary" data-debug="goldenClick">Make click button golden (toggle)</button>
          <button class="btn secondary" data-debug="goodLuck">Good luck (toggle: buildings can't break)</button>
          <button class="btn secondary" data-debug="resetUberBuffs">Reset uber-buffs</button>
          <button class="btn secondary" data-debug="addTreasury">+1000 treasury coins</button>
          <button class="btn secondary" data-debug="addDevSword">Add Developer Sword</button>
          <button class="btn secondary" data-debug="repairAllBuildings">Repair all buildings</button>
          <button class="btn danger" data-debug="resetAll">Reset all levels and points</button>
        </div>
      </div>

      <button id="debug-close" class="btn tiny">Close</button>
    </div>
  </div>

  <!-- GAME SCREEN -->
  <div id="game-screen" class="screen hidden game-layout">



    <!-- TITLE -->
    <div class="game-title">Medieval Pixel Idle</div>

    <!-- STATS -->
    <div class="stats-container">
      <div class="stats-bar">
        <div class="stat">
          <span class="stat-label">Points</span>
          <span id="points" class="stat-value">0.0000</span>
        </div>
        <div class="stat">
          <span class="stat-label">Points/sec</span>
          <span id="pps" class="stat-value">0.0000</span>
        </div>
        <div class="stat">
          <span class="stat-label">Points/click</span>
          <span id="ppc" class="stat-value">0.1111</span>
        </div>
        <div class="stat">
          <span class="stat-label">Souls</span>
          <span id="souls-display" class="stat-value">0</span>
        </div>

        <div class="userbox">
          <span id="username-display"></span>
          <div class="settings-control-container">
            <button id="settings-toggle-btn" class="btn tiny" title="Settings">‚öôÔ∏è</button>
            <div id="settings-menu" class="settings-menu hidden">
              <div class="settings-menu-header">Settings</div>
              <div class="volume-control-group">
                <div class="volume-control-label">Music Volume</div>
                <input type="range" id="music-volume-slider" min="0" max="100" value="50" class="volume-slider">
                <div class="music-volume-value"><span id="music-volume-display">50</span>%</div>
              </div>
              <div class="volume-control-group" style="margin-top: 16px;">
                <div class="volume-control-label">Sound Effects Volume</div>
                <input type="range" id="sound-effects-volume-slider" min="0" max="100" value="50" class="volume-slider">
                <div class="music-volume-value"><span id="sound-effects-volume-display">50</span>%</div>
              </div>
              <div class="volume-control-group" style="margin-top: 16px;">
                <div class="volume-control-label">Opacity</div>
                <input type="range" id="opacity-slider" min="0" max="100" value="0" class="volume-slider">
                <div class="music-volume-value"><span id="opacity-display">0</span>%</div>
              </div>
              <div class="volume-control-group" style="margin-top: 16px;">
                <div class="volume-control-label">Seasonal Theme</div>
                <input type="checkbox" id="seasonal-theme-checkbox" checked style="flex: 0; width: 40px; height: 40px; margin: 0; cursor: pointer; accent-color: var(--poe-orange);">
                <div class="music-volume-value" style="min-width: auto;"></div>
              </div>
              <div class="volume-control-group" style="margin-top: 16px;">
                <div class="volume-control-label">FPS Limit</div>
                <select id="fps-limit-select" style="flex: 1; padding: 8px; border-radius: 4px; background: rgba(26, 26, 26, 0.9); border: 1px solid var(--border-orange); color: var(--text-bright); cursor: pointer;">
                  <option value="0">Unlimited</option>
                  <option value="30">30 FPS</option>
                  <option value="60">60 FPS</option>
                  <option value="120">120 FPS</option>
                  <option value="180">180 FPS</option>
                  <option value="240">240 FPS</option>
                </select>
                <div class="music-volume-value" style="min-width: auto;"></div>
              </div>
              <div class="volume-control-group" style="margin-top: 16px;">
                <div class="volume-control-label">Limit FPS in Background</div>
                <input type="checkbox" id="fps-limit-background-checkbox" style="flex: 0; width: 40px; height: 40px; margin: 0; cursor: pointer; accent-color: var(--poe-orange);">
                <div class="music-volume-value" style="min-width: auto;"></div>
              </div>
            </div>
          </div>
          <button id="hints-toggle-btn" class="btn tiny" title="Toggle hints">üí°</button>
          <button id="stats-btn" class="btn tiny">Stats</button>
          <button id="inventory-btn" class="btn tiny" title="Inventory">üéí</button>
          <button id="merchant-btn" class="btn tiny" title="Her Barrus - Merchant">üè™</button>
          <button id="general-btn" class="btn tiny" title="Call General for Defense">‚öîÔ∏è</button>
          <button id="debug-open" class="btn tiny secondary">debug</button>
        </div>
      </div>
      
      <div class="treasury-actions" id="treasury-actions"></div>
    </div>

    <!-- Treasury row -->
    <div class="treasury-row">
      <div class="treasury-bar">
        <div class="treasury-progress">
          <div id="treasury-progress-fill"></div>
          <div class="treasury-overlay">
            <span class="treasury-label">Treasury</span>
            <span id="treasury-value" class="treasury-amount">0 / 1000</span>
            <span id="treasury-regen" class="treasury-regen">+1 /s</span>
          </div>
        </div>
      </div>
    </div>

    <!-- MAIN CONTENT: three columns -->
    <main class="game-columns">

      <!-- LEFT COLUMN (1/3) ‚Äì cursor-related + notifications -->
      <section class="col-left">
        <div class="click-area">
          <div class="click-row">
            <button id="click-btn" class="btn click-btn">Click</button>

            <!-- middle column: status -->
            <div class="click-middle">
              <div id="click-status" class="status-badge">Ready</div>
            </div>

            <!-- bulk buttons: x1 and x10 -->
            <div class="bulk-buttons" id="bulk-buttons">
              <button class="btn tiny bulk" data-bulk="1">x1</button>
              <button class="btn tiny bulk" data-bulk="10">x10</button>
            </div>

            <!-- right column: Buy and UP (Buy to the right of Click, UP under Buy) -->
            <div class="quick-actions">
              <button id="click-buy" class="btn primary">Buy "Click" level</button>
              <button id="click-seg-upgrade" class="btn small mt-6 seg-upgrade-btn hidden">UP</button>
            </div>
          </div>

          <div class="building-info">
            <div class="building-name">Click</div>
            <div class="building-meta"><strong>Level:</strong> <span id="click-level">0</span> / <span id="click-max">1000</span></div>
            <div class="building-meta"><strong>Income/click:</strong> <span id="click-income">0.1111</span></div>
            <div class="building-meta"><strong>Next Cost:</strong> <span id="click-cost">7.7720</span></div>
          </div>
        </div>

        <div class="notice-board">
          <h3>Notifications</h3>
          <div id="toasts" class="toasts"></div>
        </div>

        <div class="endgame">
          <button id="endgame-btn" class="btn hidden">End Game (Reset)</button>
          <button id="uber-mode-btn" class="btn hidden">Enter Uber Mode</button>
        </div>
      </section>

      <!-- CENTER COLUMN (2/3) ‚Äì buildings list (scrollable) -->
      <section class="col-center">
        <!-- Sort button between treasury and buildings -->
        <div class="sort-button-container">
          <button id="sort-buildings-btn" class="btn small" title="Sort buildings">Sort: Default</button>
        </div>
        <div id="buildings-list" class="buildings-list"></div>
      </section>

      <!-- RIGHT COLUMN (3/3) ‚Äì Uber building (visible, placed on the right third) -->
      <!-- RIGHT COLUMN (3/3) ‚Äì Uber building (visually matches building cards, height equals Click block) -->
<section class="col-right">
  <div class="building-card" id="uber-card" aria-label="Uber Turbo Building">
    <div class="building-pixel uber-pixel" id="uber-pixel"></div>

    <div class="building-info">
      <div class="building-name">Citadel</div>
      <div class="building-meta"><strong>Level:</strong> <span id="uber-level">0</span> / <span id="uber-max">19</span></div>
      <div class="building-meta"><strong>Income/sec:</strong> <span id="uber-income">0.0000</span></div>
      <div class="building-meta"><strong>Next Cost:</strong> <span id="uber-cost">0.0000</span></div>
    </div>

    <div class="building-actions" id="uber-actions">
      <button id="uber-buy" class="btn primary" disabled>Buy levels</button>
    </div>
  </div>

  <!-- Achievements section -->
  <div class="achievements-container">
    <div class="achievements-header">
      <h3 class="achievements-title">Achievements</h3>
      <span id="achievements-count" class="achievements-count">0</span>
    </div>
    <div id="achievements-list" class="achievements-list"></div>
  </div>
</section>

    </main>

    <!-- SPIDER -->
    <div id="spider" class="spider hidden" title="Catch the spider!"></div>
    
    <!-- ANGRY BARMATUN -->
    <div id="angry-barmatun" class="spider hidden" title="Angry Barmatun - click to interact!"></div>
    
    <!-- ELF ARCHER -->
    <div id="elf-archer" class="elf-archer hidden" title="Elf Archer - click to scare away!"></div>

    <!-- EXPERIENCE BAR -->
    <div id="experience-bar-container" class="experience-bar-container">
      <div class="experience-bar-wrapper">
        <div class="experience-bar">
          <div class="experience-segments">
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
            <div class="experience-segment"></div>
          </div>
          <div id="experience-bar-fill" class="experience-bar-fill"></div>
          <div class="experience-bar-content">
            <span id="experience-level" class="experience-level">Level 1</span>
            <span id="experience-bar-text" class="experience-bar-text">0 / 100 XP (0%)</span>
          </div>
        </div>
      </div>
    </div>

  </div>

<!-- Updates button (fixed top-right) -->
<button id="updates-btn" aria-haspopup="dialog" aria-controls="updates-modal" title="Updates">Updates</button>

<!-- Updates modal -->
<div id="updates-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card" role="document" aria-labelledby="updates-title">
    <div class="modal-header">
      <h3 id="updates-title">Game updates</h3>
      <button class="modal-close" id="updates-close" aria-label="Close updates">‚úï</button>
    </div>
    <div class="modal-body" id="updates-body">
      <!-- –°—é–¥–∞ JS –≤—Å—Ç–∞–≤–∏—Ç —Å–ø–∏—Å–æ–∫ –∞–ø–¥–µ–π—Ç–æ–≤ -->
    </div>
    <div class="modal-footer">
    </div>
  </div>
</div>

<!-- Confirmation modal -->
<div id="confirm-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card" role="document" aria-labelledby="confirm-title">
    <div class="modal-header">
      <h3 id="confirm-title">Confirmation</h3>
    </div>
    <div class="modal-body" id="confirm-body">
      <p id="confirm-message"></p>
    </div>
    <div class="modal-footer">
      <button id="confirm-yes" class="btn primary">Yes</button>
      <button id="confirm-no" class="btn">No</button>
    </div>
  </div>
</div>

<!-- Class Selection Modal -->
<div id="class-selection-modal" role="dialog" aria-modal="true" aria-hidden="true" class="modal hidden">
  <div class="modal-card class-selection-card" role="document" aria-labelledby="class-selection-title">
    <div class="modal-header">
      <h3 id="class-selection-title">Select Your Class</h3>
    </div>
    <div class="modal-body class-selection-body">
      <p style="margin-bottom: 16px; color: var(--text-dim); text-align: center;">Choose your character class. This will determine your playstyle and available weapons.</p>
      <div class="class-carousel-container">
        <button class="class-carousel-btn class-carousel-prev" id="class-carousel-prev" aria-label="Previous class">‚Äπ</button>
        <div class="class-carousel-wrapper" id="class-carousel-wrapper">
          <div class="class-carousel" id="class-carousel">
            <!-- Classes will be populated by JavaScript -->
          </div>
        </div>
        <button class="class-carousel-btn class-carousel-next" id="class-carousel-next" aria-label="Next class">‚Ä∫</button>
      </div>
      <div class="class-carousel-indicators" id="class-carousel-indicators">
        <!-- Indicators will be populated by JavaScript -->
      </div>
    </div>
  </div>
</div>

<!-- Statistics modal -->
<div id="stats-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card" role="document" aria-labelledby="stats-title">
    <div class="modal-header">
      <h3 id="stats-title">Statistics</h3>
      <button class="modal-close" id="stats-close" aria-label="Close statistics">‚úï</button>
    </div>
    <div class="modal-body" id="stats-body">
      <!-- Statistics will be rendered here -->
    </div>
  </div>
</div>

<!-- Inventory modal -->
<div id="inventory-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card inventory-modal-card" role="document" aria-labelledby="inventory-title">
    <div class="modal-header">
      <h3 id="inventory-title">Inventory</h3>
      <div style="display: flex; align-items: center; gap: 12px;">
        <div id="inventory-class-display" style="padding: 4px 8px; background: rgba(255, 140, 0, 0.2); border-radius: 4px; font-size: 0.9em; color: var(--poe-orange); display: flex; align-items: center; gap: 8px;">
          <span id="inventory-class-name">No Class</span>
          <button id="inventory-change-class-btn" class="btn tiny" title="Change Class (15000 Souls)" style="padding: 2px 6px; font-size: 0.8em;">üîÑ</button>
        </div>
        <button class="modal-close" id="inventory-close" aria-label="Close inventory">‚úï</button>
      </div>
    </div>
    <div class="inventory-body">
      <!-- Top section: Equipment and Stats -->
      <div class="inventory-top-section">
        <!-- Left: Equipment -->
        <div class="inventory-equipment">
          <h4 class="inventory-section-title">Equipment</h4>
          <div class="equipment-grid">
            <!-- Row 1: Helmet (centered) -->
            <div class="equipment-slot equipment-slot-center" data-slot="helmet" title="Helmet">
              <div class="equipment-slot-icon">‚õëÔ∏è</div>
              <div class="equipment-slot-label">Head</div>
            </div>
            <!-- Row 2: Shoulders, Chest, Necklace -->
            <div class="equipment-slot" data-slot="shoulders" title="Shoulders">
              <div class="equipment-slot-icon">üéñÔ∏è</div>
              <div class="equipment-slot-label">Shoulder</div>
            </div>
            <div class="equipment-slot" data-slot="chest" title="Chest">
              <div class="equipment-slot-icon">ü¶∫</div>
              <div class="equipment-slot-label">Chest</div>
            </div>
            <div class="equipment-slot" data-slot="necklace" title="Necklace">
              <div class="equipment-slot-icon">üìø</div>
              <div class="equipment-slot-label">Necklace</div>
            </div>
            <!-- Row 3: Ring, Gloves, Ring -->
            <div class="equipment-slot" data-slot="ring1" title="Ring 1">
              <div class="equipment-slot-icon">üíç</div>
              <div class="equipment-slot-label">Ring</div>
            </div>
            <div class="equipment-slot" data-slot="gloves" title="Gloves">
              <div class="equipment-slot-icon">üß§</div>
              <div class="equipment-slot-label">Gloves</div>
            </div>
            <div class="equipment-slot" data-slot="ring2" title="Ring 2">
              <div class="equipment-slot-icon">üíç</div>
              <div class="equipment-slot-label">Ring</div>
            </div>
            <!-- Row 4: Accessory x3 -->
            <div class="equipment-slot" data-slot="accessory1" title="Accessory 1">
              <div class="equipment-slot-icon">‚ú®</div>
              <div class="equipment-slot-label">Accessory</div>
            </div>
            <div class="equipment-slot" data-slot="accessory2" title="Accessory 2">
              <div class="equipment-slot-icon">‚ú®</div>
              <div class="equipment-slot-label">Accessory</div>
            </div>
            <div class="equipment-slot" data-slot="accessory3" title="Accessory 3">
              <div class="equipment-slot-icon">‚ú®</div>
              <div class="equipment-slot-label">Accessory</div>
            </div>
            <!-- Row 5: Weapon, Legs, Shield -->
            <div class="equipment-slot" data-slot="weapon-right" title="Right Hand Weapon">
              <div class="equipment-slot-icon">‚öîÔ∏è</div>
              <div class="equipment-slot-label">Weapon</div>
            </div>
            <div class="equipment-slot" data-slot="legs" title="Legs">
              <div class="equipment-slot-icon">üëñ</div>
              <div class="equipment-slot-label">Legs</div>
            </div>
            <div class="equipment-slot" data-slot="weapon-left" title="Left Hand Weapon/Shield">
              <div class="equipment-slot-icon">üõ°Ô∏è</div>
              <div class="equipment-slot-label">Shield</div>
            </div>
            <!-- Row 6: Boots (centered) -->
            <div class="equipment-slot equipment-slot-center" data-slot="boots" title="Boots">
              <div class="equipment-slot-icon">üë¢</div>
              <div class="equipment-slot-label">Boots</div>
            </div>
          </div>
        </div>
        
        <!-- Right: Stats -->
        <div class="inventory-stats">
          <h4 class="inventory-section-title">Stats</h4>
          <div class="stats-list">
            <div class="stat-item">
              <span class="stat-label">HP:</span>
              <span class="stat-value" id="inv-hp">100 / 100</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Damage:</span>
              <span class="stat-value" id="inv-damage">10</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Armor:</span>
              <span class="stat-value" id="inv-armor">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Crit Chance:</span>
              <span class="stat-value" id="inv-crit-chance">5%</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Crit Multiplier:</span>
              <span class="stat-value" id="inv-crit-mult">2.0x</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Dodge Chance:</span>
              <span class="stat-value" id="inv-dodge">0%</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">HP Regen:</span>
              <span class="stat-value" id="inv-hp-regen">0 /s</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Mana:</span>
              <span class="stat-value" id="inv-mana">50 / 50</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Bottom section: Inventory Grid -->
      <div class="inventory-bottom-section">
        <div class="inventory-header">
          <h4 class="inventory-section-title">Inventory</h4>
          <div class="inventory-controls">
            <div class="inventory-sort-controls">
              <button class="btn tiny" id="sort-level" title="Sort by Level">üìä Level</button>
              <button class="btn tiny" id="sort-type" title="Sort by Type">üîß Type</button>
              <button class="btn tiny" id="sort-rarity" title="Sort by Rarity">üíé Rarity</button>
            </div>
            <div class="inventory-sell-controls" id="inventory-sell-controls">
              <!-- Sell all buttons will be added here by JavaScript -->
            </div>
          </div>
        </div>
        <div class="inventory-grid" id="inventory-grid">
          <!-- 10x4 = 40 slots -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Combat Screen -->
<div id="combat-screen" class="combat-screen hidden">
  <div class="combat-container">
    <div class="combat-header">
      <h3>Cursed Pit - Level <span id="pit-level">1</span></h3>
      <div class="combat-header-controls">
        <div id="player-class-display" style="margin-right: 8px; padding: 4px 8px; background: rgba(255, 140, 0, 0.2); border-radius: 4px; font-size: 0.9em; color: var(--poe-orange);">
          <span id="player-class-name">No Class</span>
        </div>
        <button id="combat-select-wave-btn" class="btn tiny" title="Select Wave">üìã</button>
        <button id="combat-close" class="btn tiny">‚úï</button>
      </div>
    </div>
    
    <!-- Progress Bar -->
    <div class="pit-progress-container" style="margin: 12px 0; padding: 0 16px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
        <span style="font-size: 0.9em; color: var(--text-dim);">Progress</span>
        <span id="pit-progress-text" style="font-size: 0.9em; font-weight: bold; color: var(--poe-orange);">0%</span>
      </div>
      <div style="width: 100%; height: 20px; background: rgba(0, 0, 0, 0.3); border-radius: 10px; overflow: hidden; position: relative;">
        <div id="pit-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--poe-orange), #ffaa00); transition: width 0.3s ease; border-radius: 10px;"></div>
      </div>
      <button id="summon-boss-btn" class="btn primary" style="width: 100%; margin-top: 8px; display: none;">Summon Boss</button>
    </div>
    
    <div class="combat-arena">
      <!-- Enemies Section (for waves) -->
      <div id="enemies-container" style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; min-height: 200px; padding: 16px;">
        <!-- Enemies will be dynamically added here -->
      </div>
      
      <!-- Boss Section (hidden until summoned) -->
      <div class="combat-boss" id="boss-section" style="display: none;">
        <div class="combat-entity-name" id="boss-name">Boss</div>
        <div class="combat-hp-bar-container">
          <div class="combat-hp-bar" id="boss-hp-bar"></div>
          <div class="combat-hp-text" id="boss-hp-text">100 / 100</div>
        </div>
        <div class="boss-stats">
          <div class="boss-stat-item">
            <span>Damage:</span>
            <span id="boss-damage">0</span>
          </div>
          <div class="boss-stat-item">
            <span>Armor:</span>
            <span id="boss-armor">0</span>
          </div>
          <div class="boss-stat-item">
            <span>Dodge:</span>
            <span id="boss-dodge">0%</span>
          </div>
          <div class="boss-stat-item" id="boss-hp-regen-container" style="display: none;">
            <span>HP Regen:</span>
            <span id="boss-hp-regen">0/s</span>
          </div>
          <div class="boss-stat-item" id="boss-element-container" style="display: none;">
            <span id="boss-element-label">Element:</span>
            <span id="boss-element-info"></span>
          </div>
        </div>
        <div id="boss-debuffs" class="boss-debuffs"></div>
        <div id="debuff-info-window" class="debuff-info-window hidden"></div>
        <div class="combat-entity-icon">üëπ</div>
      </div>
      
      <!-- Player Section -->
      <div class="combat-player">
        <div class="combat-entity-icon">üõ°Ô∏è</div>
        <div class="combat-hp-bar-container">
          <div class="combat-hp-bar player-hp-bar" id="player-hp-bar"></div>
          <div class="combat-hp-text" id="player-hp-text">100 / 100</div>
        </div>
        <div id="player-debuffs" class="player-debuffs"></div>
        <div id="debuff-info-window-player" class="debuff-info-window hidden"></div>
        <div class="combat-entity-name">Player</div>
      </div>
    </div>
    
    <div class="combat-controls">
      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9em; color: var(--text-dim);">
          <input type="checkbox" id="combat-auto-attack" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--poe-orange);">
          <span>Auto Attack</span>
        </label>
      </div>
      <button id="combat-attack-btn" class="btn primary">Attack</button>
      <div class="combat-stats">
        <div class="combat-stat-item">
          <span>Damage:</span>
          <span id="combat-damage">10</span>
        </div>
        <div class="combat-stat-item">
          <span>Armor:</span>
          <span id="combat-armor">0</span>
        </div>
        <div class="combat-stat-item">
          <span>Dodge:</span>
          <span id="combat-dodge">0%</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- King element (appears/disappears via script) -->
<div id="king" class="king" title="King"></div>

<!-- Merchant modal - Her Barrus -->
<div id="merchant-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card merchant-modal-card" role="document" aria-labelledby="merchant-title">
    <div class="modal-header">
      <div style="display: flex; flex-direction: column; gap: 4px;">
        <h3 id="merchant-title">üè™ Her Barrus - Merchant</h3>
        <div id="merchant-souls-display" style="font-size: 14px; color: var(--text-dim); display: flex; align-items: center; gap: 4px;">
          <span>üíÄ</span>
          <span id="merchant-souls-amount">0</span>
          <span>Souls</span>
        </div>
      </div>
      <button class="modal-close" id="merchant-close" aria-label="Close merchant">‚úï</button>
    </div>
    <div class="modal-body merchant-body">
      <div class="merchant-tabs">
        <button class="merchant-tab-btn active" data-tab="weapons">Weapons</button>
        <button class="merchant-tab-btn" data-tab="armor">Armor</button>
        <button class="merchant-tab-btn" data-tab="accessories">Accessories</button>
      </div>
      <div class="merchant-content">
        <div id="merchant-weapons-tab" class="merchant-tab-content active">
          <div class="merchant-items-grid" id="merchant-weapons-grid">
            <!-- Weapons will be generated here -->
          </div>
        </div>
        <div id="merchant-armor-tab" class="merchant-tab-content">
          <div class="merchant-items-grid" id="merchant-armor-grid">
            <!-- Armor will be generated here -->
          </div>
        </div>
        <div id="merchant-accessories-tab" class="merchant-tab-content">
          <div class="merchant-items-grid" id="merchant-accessories-grid">
            <!-- Accessories will be generated here -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Casino modal -->
<div id="casino-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card" role="document" aria-labelledby="casino-title">
    <div id="casino-result-overlay" class="casino-result-overlay hidden">
      <div class="casino-result-content">
        <div id="casino-result-dice" class="casino-result-dice"></div>
        <div id="casino-result-text" class="casino-result-text"></div>
        <div id="casino-result-amount" class="casino-result-amount"></div>
      </div>
    </div>
    <div class="modal-header">
      <h3 id="casino-title">üé≤ CASINO LOSEWIN-LINE</h3>
      <button class="modal-close" id="casino-close" aria-label="Close casino">‚úï</button>
    </div>
    <div class="modal-body" id="casino-body">
      <div class="casino-content">
        <div class="casino-section">
          <h4>Select Bet Percentage:</h4>
          <div class="casino-buttons">
            <button class="btn casino-bet-btn" data-percent="10">10%</button>
            <button class="btn casino-bet-btn" data-percent="20">20%</button>
            <button class="btn casino-bet-btn" data-percent="30">30%</button>
            <button class="btn casino-bet-btn" data-percent="40">40%</button>
            <button class="btn casino-bet-btn" data-percent="50">50%</button>
            <button class="btn casino-bet-btn" data-percent="100">100%</button>
          </div>
          <div class="casino-stake-info">
            <p>Selected: <span id="casino-stake-percent">-</span></p>
            <p>Stake: <span id="casino-stake-amount">-</span> points</p>
          </div>
        </div>
        <div class="casino-section">
          <h4>Choose Dice Face (1-6):</h4>
          <div class="casino-dice">
            <button class="btn casino-dice-btn" data-face="1">1</button>
            <button class="btn casino-dice-btn" data-face="2">2</button>
            <button class="btn casino-dice-btn" data-face="3">3</button>
            <button class="btn casino-dice-btn" data-face="4">4</button>
            <button class="btn casino-dice-btn" data-face="5">5</button>
            <button class="btn casino-dice-btn" data-face="6">6</button>
          </div>
          <div class="casino-face-info">
            <p>Selected: <span id="casino-face-selected">-</span></p>
          </div>
        </div>
        <div class="casino-info">
          <p><strong>Win:</strong> stake x3 is returned</p>
          <p><strong>Lose:</strong> stake x1.2 is lost (can result in negative points)</p>
          <p class="casino-warning">‚ö†Ô∏è Betting 100% can result in negative points if you lose!</p>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button id="casino-roll-btn" class="btn primary" disabled>Roll Dice</button>
      <button id="casino-cancel-btn" class="btn">Cancel</button>
    </div>
  </div>
</div>

<!-- King mini-game modal -->
<div id="king-modal" aria-hidden="true">
  <div class="king-game" role="dialog" aria-modal="true" aria-label="King mini game">
    <div class="kg-top">
      <div>King: catch the crowns!</div>
      <div class="kg-timer" id="king-game-timer">8.0s</div>
    </div>
    <div class="kg-arena" id="king-arena" tabindex="0" aria-label="Arena for crowns">
      <!-- crowns will be added here dynamically -->
    </div>
    <div class="kg-footer">
      <div id="king-game-status" class="muted">Click 12 crowns in 8 seconds. Clicking the background is an instant miss.</div>
      <div>
        <button id="king-game-close" class="btn small">Cancel</button>
      </div>
    </div>
  </div>
</div>


  <canvas id="sprite-canvas" class="hidden"></canvas>
  <!-- Background music -->
  <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –º—É–∑—ã–∫–∏ –∏–∑ –ø–∞–ø–∫–∏ music -->
  <audio id="background-music" preload="auto">
    <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
  </audio>
  <script src="experience.js"></script>
  <script src="combat.js"></script>
  <script src="script.js"></script>
</body>
</html>
