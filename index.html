<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Medieval Pixel Idle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="style.css"/>
  <style>
  /* Global reset to ensure full-bleed layout */
  html, body {
    width: 100%;
    height: 100%;
  }
  body {
    margin: 0; /* убираем дефолтный отступ документа */
  }

 /* Родительский контейнер игры */
.game-layout {
  width: 100%;       /* во всю ширину окна */
  max-width: none;    /* убираем ограничение */
  margin: 0;          /* убираем автоцентрирование */
  box-sizing: border-box;
}

/* Сетка колонок */
.game-columns {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr)); /* три равные части */
  gap: 20px;
  width: 100%;        /* ширина наследуется от родителя */
  padding: 20px;
  align-items: start;
}


  /* Ensure left column content (cursor area + notifications) stacks vertically */
  .col-left {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 60vh;
    width: 100%;
  }

  /* Center column: buildings list should be scrollable and centered */
  .col-center {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 60vh;
    align-items: stretch;
    width: 100%;
  }
  #buildings-list {
    overflow-y: auto;
    max-height: calc(100vh - 320px);
    padding-right: 6px;
  }

  /* Right column: Uber building container */
  .col-right {
    display: flex;
    flex-direction: column;
    gap: 16px;
    min-height: 60vh;
    align-items: stretch;
    width: 100%;
  }

  /* Make sure the Uber card visually matches building cards */
  .uber-building-card {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 12px;
    align-items: center;
    background: linear-gradient(180deg,#1f1b1a,#2b2624);
    border-radius:8px;
    padding:12px;
    border:2px solid rgba(0,0,0,0.6);
    box-shadow: inset 0 6px 12px rgba(0,0,0,0.45);
    min-height:86px;
  }
  .uber-pixel { width:80px;height:80px;border-radius:8px;background:linear-gradient(180deg,#3a2f2b,#1f1715);border:2px solid rgba(0,0,0,0.6); }
  .uber-actions { display:flex;flex-direction:column;gap:8px;align-items:flex-end; }

  /* Notifications / toasts styling adjustments to keep them compact */
  .notice-board { min-height: auto; max-height: 40vh; overflow-y: auto; }
  .toasts .toast { display:flex;align-items:center;gap:8px;justify-content:space-between; }

  /* Ensure click-area remains usable and not stretched */
  .click-area { width:100%; }

  /* Responsive: stack columns on small screens */
  @media (max-width: 980px) {
    .game-columns { 
      grid-template-columns: 1fr; 
      width: 100%;         /* на мобильных используем ширину контейнера */
      padding: 16px;       /* чуть меньше внутренний отступ */
    }
    #buildings-list { max-height: 40vh; }
  }




</style>


</head>
<body>

  <!-- AUTH SCREEN -->
  <div id="auth-screen" class="screen">
    <div class="auth-card">
      <h1>Medieval Pixel Idle</h1>
      <p class="subtitle">Welcome traveler. Log in or register to begin.</p>

      <div class="auth-tabs">
        <button class="tab-btn active" data-tab="login">Login</button>
        <button class="tab-btn" data-tab="register">Register</button>
      </div>

      <div class="auth-panels">
        <div class="auth-panel" id="login-panel">
          <label class="label">
            <span>Username</span>
            <input id="login-username" type="text" maxlength="24" autocomplete="username" />
          </label>
          <label class="label">
            <span>Password</span>
            <input id="login-password" type="password" maxlength="64" autocomplete="current-password"/>
          </label>
          <button id="login-btn" class="btn primary">Enter</button>
        </div>

        <div class="auth-panel hidden" id="register-panel">
          <label class="label">
            <span>Username</span>
            <input id="register-username" type="text" maxlength="24" autocomplete="username" />
          </label>
          <label class="label">
            <span>Password</span>
            <input id="register-password" type="password" maxlength="64" autocomplete="new-password"/>
          </label>
          <button id="register-btn" class="btn primary">Create account</button>
        </div>
      </div>

      <div class="auth-footer">
        <small>Your progress is autosaved every second.</small>
      </div>
    </div>
  </div>

  <!-- DEBUG -->
  <div id="debug-modal" class="modal hidden">
    <div class="modal-card">
      <h2>Debug Panel</h2>

      <div id="debug-lock">
        <p>Enter password:</p>
        <input id="debug-pass" type="password" placeholder="Password"/>
        <button id="debug-unlock-btn" class="btn primary">Unlock</button>
      </div>

      <div id="debug-tools" class="hidden">
        <div class="debug-actions">
          <button class="btn secondary" data-debug="addPoints">Add 10000 points</button>
          <button class="btn secondary" data-debug="addAllBuildingLevels">Add 100 levels to all buildings</button>
          <button class="btn secondary" data-debug="addClickLevels">Add 100 levels to Click</button>
          <button class="btn secondary" data-debug="clickIncomeBoost">Click income x1000</button>
          <button class="btn secondary" data-debug="spawnSpider">Spawn spider</button>
          <button class="btn secondary" data-debug="breakClick">Break click button</button>
          <button class="btn secondary" data-debug="goldenClick">Make click button golden</button>
          <button class="btn danger" data-debug="resetAll">Reset all levels and points</button>
        </div>
      </div>

      <button id="debug-close" class="btn tiny">Close</button>
    </div>
  </div>

  <!-- GAME SCREEN -->
  <div id="game-screen" class="screen hidden game-layout">



    <!-- TITLE -->
    <div class="game-title">Medieval Pixel Idle</div>

    <!-- STATS -->
    <div class="stats-bar">
      <div class="stat">
        <span class="stat-label">Points</span>
        <span id="points" class="stat-value">0.0000</span>
      </div>
      <div class="stat">
        <span class="stat-label">Points/sec</span>
        <span id="pps" class="stat-value">0.0000</span>
      </div>
      <div class="stat">
        <span class="stat-label">Points/click</span>
        <span id="ppc" class="stat-value">0.1111</span>
      </div>

      <div class="userbox">
        <span id="username-display"></span>
        <button id="logout-btn" class="btn tiny">Logout</button>
        <button id="debug-open" class="btn tiny secondary">debug</button>
      </div>
    </div>

    <!-- MAIN CONTENT: three columns -->
    <main class="game-columns">

      <!-- LEFT COLUMN (1/3) – cursor-related + notifications -->
      <section class="col-left">
        <div class="click-area">
          <div class="click-row">
            <button id="click-btn" class="btn click-btn">Click</button>

            <!-- middle column: status -->
            <div class="click-middle">
              <div id="click-status" class="status-badge">Ready</div>
            </div>

            <!-- right column: Buy and Upgrade (Buy to the right of Click, Upgrade under Buy) -->
            <div class="quick-actions">
              <button id="click-buy" class="btn primary">Buy "Click" level</button>
              <button id="click-seg-upgrade" class="btn small mt-6 hidden">Upgrade</button>
            </div>
          </div>

          <div class="click-info">
            <div class="info-item">
              <div class="info-left"><strong>Level:</strong></div>
              <div class="info-right"><span id="click-level">0</span> / <span id="click-max">1000</span></div>
            </div>

            <div class="info-item">
              <div class="info-left"><strong>Current Income / click:</strong></div>
              <div class="info-right"><span id="click-income">0.1111</span></div>
            </div>

            <div class="info-item">
              <div class="info-left"><strong>Next Upgrade Cost:</strong></div>
              <div class="info-right"><span id="click-cost">7.7720</span></div>
            </div>

            <div class="info-item">
              <div class="info-left"><strong>Segment Upgrade:</strong></div>
              <div class="info-right"><span id="click-seg-info">Buy 10 levels to unlock</span></div>
            </div>
          </div>

          <div class="bulk-row">
            <span class="bulk-label">Bulk level:</span>
            <div class="bulk-buttons" id="bulk-buttons">
              <button class="btn tiny bulk active" data-bulk="1">x1</button>
              <button class="btn tiny bulk" data-bulk="10">x10</button>
            </div>
            <button id="click-buy-duplicate" class="btn primary hidden">Buy "Click" level</button>
          </div>
        </div>

        <div class="notice-board">
          <h3>Notifications</h3>
          <div id="toasts" class="toasts"></div>
        </div>

        <div class="endgame">
          <button id="endgame-btn" class="btn hidden">End game</button>
          <button id="continue-btn" class="btn hidden">Continue to extended caps</button>
        </div>
      </section>

      <!-- CENTER COLUMN (2/3) – buildings list (scrollable) -->
      <section class="col-center">
        <div id="buildings-list" class="buildings-list"></div>
      </section>

      <!-- RIGHT COLUMN (3/3) – Uber building (visible, placed on the right third) -->
      <section class="col-right">
        <div class="building-card uber-building-card" id="uber-card" aria-label="Uber Turbo Building">
          <div class="building-pixel uber-pixel" id="uber-pixel"></div>
          <div class="building-info">
            <div class="building-name">Citadel</div>
            <div class="building-meta"><strong>Level:</strong> <span id="uber-level">0</span> / <span id="uber-max">10</span></div>
            <div class="building-meta"><strong>Income/sec:</strong> <span id="uber-income">0.0000</span></div>
            <div class="building-meta"><strong>Next Cost:</strong> <span id="uber-cost">0.0000</span></div>
            <div class="building-meta seg-upgrade">
              <strong>Segment Upgrade:</strong>
              <span id="uber-seg-info">Buy 10 levels to unlock</span>
              <button id="uber-seg-upgrade" class="btn small hidden">Upgrade</button>
            </div>
          </div>
          <div class="building-actions uber-actions">
            <button id="uber-buy" class="btn primary" disabled>Buy levels</button>
          </div>
          <div class="uber-lock">Locked: reach level ≥ 800 on all buildings and the Click.</div>
        </div>
      </section>

    </main>

    <!-- SPIDER -->
    <div id="spider" class="spider hidden" title="Catch the spider!"></div>

  </div>

<!-- Updates button (fixed top-left) -->
<button id="updates-btn" aria-haspopup="dialog" aria-controls="updates-modal" title="Updates">Updates</button>

<!-- Updates modal -->
<div id="updates-modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card" role="document" aria-labelledby="updates-title">
    <div class="modal-header">
      <h3 id="updates-title">Game updates</h3>
      <button class="modal-close" id="updates-close" aria-label="Close updates">✕</button>
    </div>
    <div class="modal-body" id="updates-body">
      <!-- Сюда JS вставит список апдейтов -->
    </div>
    <div class="modal-footer">
    </div>
  </div>
</div>


<!-- King element (appears/disappears via script) -->
<div id="king" class="king" title="King"></div>

<!-- King mini-game modal -->
<div id="king-modal" aria-hidden="true">
  <div class="king-game" role="dialog" aria-modal="true" aria-label="King mini game">
    <div class="kg-top">
      <div>King: catch the crowns!</div>
      <div class="kg-timer" id="king-game-timer">8.0s</div>
    </div>
    <div class="kg-arena" id="king-arena" tabindex="0" aria-label="Arena for crowns">
      <!-- crowns will be added here dynamically -->
    </div>
    <div class="kg-footer">
      <div id="king-game-status" class="muted">Click 12 crowns in 8 seconds. Clicking the background is an instant miss.</div>
      <div>
        <button id="king-game-close" class="btn small">Cancel</button>
      </div>
    </div>
  </div>
</div>


  <canvas id="sprite-canvas" class="hidden"></canvas>
  <script src="script.js"></script>
</body>
</html>
